{"ast":null,"code":"var _jsxFileName = \"/Users/niwa_kazuhiro/Documents/PrivateDevelop/win-rate-react19/src/ActionState.tsx\",\n  _s = $RefreshSig$();\nimport { useActionState } from \"react\";\n\n//Formの型\n\n//Stateの型\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n//validation\nconst validationName = name => {\n  if (name === \"\") {\n    return new Error(\"名前を入力してください\");\n  } else if (name.length > 10) {\n    return new Error(\"名前は10文字以内で入力してください\");\n  }\n  return null;\n};\nconst validationAge = age => {\n  if (age <= 0) {\n    return new Error(\"年齢は0以上で入力してください\");\n  }\n  return null;\n};\nexport const FormTest3 = () => {\n  _s();\n  //初期値\n  const initialFormData = {\n    value: {\n      name: \"\",\n      age: 0\n    },\n    validationError: {\n      name: null,\n      age: null\n    },\n    apiError: null\n  };\n\n  //\n  const [formData, action, isPending] = useActionState(async (_, formData) => {\n    // FormDataをobjectに変換\n    const _formData = Object.fromEntries(formData.entries());\n    const data = {\n      name: _formData.name,\n      age: Number(_formData.age)\n    };\n\n    // validationを掛ける　いい感じのライブラリがあれば参考にする\n    const nameError = validationName(data.name);\n    const ageError = validationAge(data.age);\n    if (nameError || ageError) {\n      return {\n        value: {\n          name: data.name,\n          age: data.age\n        },\n        validationError: {\n          name: nameError,\n          age: ageError\n        },\n        apiError: null\n      };\n    }\n\n    // ここでAPI処理を実装・今回は2秒待ってエラーを返す\n    await new Promise(res => setTimeout(res, 2000));\n    const apiError = new Error(\"Failed to submit data\");\n    return {\n      value: {\n        name: data.name,\n        age: data.age\n      },\n      validationError: {\n        name: nameError,\n        age: ageError\n      },\n      apiError: apiError\n    };\n  }, initialFormData);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      action: action,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u540D\\u524D\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"name\",\n            defaultValue: formData.value.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: formData.validationError.name && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: formData.validationError.name.message\n          }, void 0, false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u5E74\\u9F62\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            name: \"age\",\n            defaultValue: formData.value.age\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: formData.validationError.age && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: formData.validationError.age.message\n          }, void 0, false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        formAction: action,\n        disabled: isPending,\n        children: [\"\\u9001\\u4FE1\", isPending && \"中\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: formData.apiError && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: formData.apiError.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 35\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n_s(FormTest3, \"diMbxFi9YqfWbXB6tbZ5pie/7qo=\", false, function () {\n  return [useActionState];\n});\n_c = FormTest3;\nvar _c;\n$RefreshReg$(_c, \"FormTest3\");","map":{"version":3,"names":["useActionState","jsxDEV","_jsxDEV","Fragment","_Fragment","validationName","name","Error","length","validationAge","age","FormTest3","_s","initialFormData","value","validationError","apiError","formData","action","isPending","_","_formData","Object","fromEntries","entries","data","Number","nameError","ageError","Promise","res","setTimeout","children","fileName","_jsxFileName","lineNumber","columnNumber","type","defaultValue","message","formAction","disabled","_c","$RefreshReg$"],"sources":["/Users/niwa_kazuhiro/Documents/PrivateDevelop/win-rate-react19/src/ActionState.tsx"],"sourcesContent":["import { useActionState } from \"react\";\n\n\n//Formの型\ntype FormType = {\n    name: string;\n    age: number;\n};\n//Stateの型\ntype PrevFormDataType = {\n    value: FormType;\n    validationError: { name: Error | null; age: Error | null };\n    apiError: Error | null;\n};\n\n//validation\nconst validationName = (name: string) => {\n    if (name === \"\") {\n        return new Error(\"名前を入力してください\");\n    } else if (name.length > 10) {\n        return new Error(\"名前は10文字以内で入力してください\");\n    }\n    return null;\n};\nconst validationAge = (age: number) => {\n    if (age <= 0) {\n        return new Error(\"年齢は0以上で入力してください\");\n    }\n\n    return null;\n};\n\n\nexport const FormTest3 = () => {\n    //初期値\n    const initialFormData: PrevFormDataType = {\n        value: { name: \"\", age: 0 },\n        validationError: { name: null, age: null },\n        apiError: null,\n    };\n\n    //\n    const [formData, action, isPending] = useActionState<PrevFormDataType,FormData >(\n        async (_: PrevFormDataType, formData: FormData) => {\n    // FormDataをobjectに変換\n        const _formData = Object.fromEntries(formData.entries());\n        const data: FormType = {\n            name: _formData.name as string,\n            age: Number(_formData.age),\n    };\n\n    // validationを掛ける　いい感じのライブラリがあれば参考にする\n    const nameError = validationName(data.name);\n    const ageError = validationAge(data.age);\n        if (nameError || ageError) {\n            return {\n                value: { name: data.name, age: data.age },\n                validationError: {\n                name: nameError,\n                age: ageError,\n            },\n        apiError: null,\n        };\n    }\n\n    // ここでAPI処理を実装・今回は2秒待ってエラーを返す\n    await new Promise((res) => setTimeout(res, 2000));\n    const apiError = new Error(\"Failed to submit data\");\n\n    return {\n        value: { name: data.name, age: data.age },\n        validationError: {\n            name: nameError,\n            age: ageError,\n        },\n        apiError: apiError,\n    };\n    }, initialFormData);\n\n    return (\n        <>\n            <form action={action} >\n        <label>\n            <div >\n                <span >名前：</span>\n                <input\n                    type=\"text\"\n                    name=\"name\"\n                    defaultValue={formData.value.name}\n                />\n            </div>\n                <span >\n                    {formData.validationError.name && (\n                        <>\n                            {formData.validationError.name.message}\n                        </>\n                    )}\n                </span>\n        </label>\n        <label>\n            <div >\n                <span>年齢：</span>\n                <input\n                    type=\"number\"\n                    name=\"age\"\n                    defaultValue={formData.value.age}\n                />\n            </div>\n            <span>\n                {formData.validationError.age && (\n                    <>\n                        {formData.validationError.age.message}\n                    </>\n                )}\n            </span>\n        </label>\n        <button\n            type=\"submit\"\n            formAction={action}\n            disabled={isPending}\n        >\n            送信{isPending && \"中\"}\n        </button>\n        <span>\n            {formData.apiError && <p>{formData.apiError.message}</p>}\n        </span>\n            </form>\n    </>\n    );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}